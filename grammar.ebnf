program       = { newline | comment } [ statement { separator statement } ] { newline | comment } ;
statement     = import_stmt | let_stmt | if_stmt | while_stmt | expr_stmt ;
import_stmt   = "import" module_name "as" ident ;
module_name   = ident { "." ident } ;
let_stmt      = "let" ident "=" expression ;
if_stmt       = "if" expression ":" newline block "end" ;
while_stmt    = "while" expression ":" newline block "end" ;
block         = { newline | comment } [ statement { separator statement } ] { newline | comment } ;
expr_stmt     = expression ;
separator     = { comment } newline { newline | comment } ;

expression    = comparison ;
comparison    = term { ("==" | "!=" | "<" | "<=" | ">" | ">=") term } ;
term          = unary { ("*" | "/") unary } ;
unary         = [ "-" ] primary ;
primary       = int_lit | string_lit | object_lit | variable | call | "(" expression ")" ;

variable      = ident { "." ident } ;
call          = callee "(" [ expression { "," expression } ] ")" ;
callee        = ident { "." ident } ;
object_lit    = "{" [ object_pair { "," object_pair } ] "}" ;
object_pair   = (ident | string_lit) ":" expression ;

# Built-ins (documented subset of valid calls)
print_call    = "print" "(" [ expression { "," expression } ] ")" ;
rand_seed     = "random.seed" "(" expression ")" ;
rand_int      = "random.randint" "(" expression "," expression ")" ;
rand_range    = "random.randrange" "(" expression "," expression ")" ;
rand_floati   = "random.random" "(" ")" ;
rand_chance   = "random.chance" "(" expression ")" ;
noise_seed    = "noise.seed" "(" expression ")" ;
noise_val2    = "noise.value2" "(" expression "," expression ")" ;
noise_val3    = "noise.value3" "(" expression "," expression "," expression ")" ;
noise_sm2     = "noise.smooth2" "(" expression "," expression "," expression ")" ;
noise_fr2     = "noise.fractal2" "(" expression "," expression "," expression "," expression "," expression ")" ;
col_aabb      = "collision.aabb" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
col_prect     = "collision.point_in_rect" "(" expression "," expression "," expression "," expression "," expression "," expression ")" ;
col_circle    = "collision.circle" "(" expression "," expression "," expression "," expression "," expression "," expression ")" ;
col_crect     = "collision.circle_rect" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
col_pcircle   = "collision.point_in_circle" "(" expression "," expression "," expression "," expression "," expression ")" ;
col_srect     = "collision.segment_rect" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
col_scircle   = "collision.segment_circle" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
net_host      = "net.host" "(" expression ")" ;
net_join      = "net.join" "(" string_lit "," expression ")" ;
net_poll      = "net.poll" "(" ")" ;
net_send_pose = "net.send_pose" "(" expression "," expression "," expression "," expression "," expression ")" ;
net_open      = "net.open" "(" ")" ;
net_hremote   = "net.has_remote" "(" ")" ;
net_hstate    = "net.has_state" "(" ")" ;
net_rx        = "net.remote_x" "(" ")" ;
net_ry        = "net.remote_y" "(" ")" ;
net_rz        = "net.remote_z" "(" ")" ;
net_ryaw      = "net.remote_yaw" "(" ")" ;
net_rpitch    = "net.remote_pitch" "(" ")" ;
net_close     = "net.close" "(" ")" ;
torch_seed    = "torch.seed" "(" expression ")" ;
torch_rint    = "torch.rand_int" "(" expression "," expression ")" ;
torch_rnorm   = "torch.rand_norm" "(" expression ")" ;
torch_relu    = "torch.relu" "(" expression ")" ;
torch_lrelu   = "torch.leaky_relu" "(" expression "," expression ")" ;
torch_sig     = "torch.sigmoid" "(" expression ")" ;
torch_tanh    = "torch.tanh" "(" expression ")" ;
torch_dot3    = "torch.dot3" "(" expression "," expression "," expression "," expression "," expression "," expression ")" ;
torch_mse     = "torch.mse" "(" expression "," expression ")" ;
torch_lerp    = "torch.lerp" "(" expression "," expression "," expression ")" ;
torch_step    = "torch.step" "(" expression "," expression "," expression ")" ;
math_array    = ("math.array" | "numpy.array") "(" [ expression { "," expression } ] ")" ;
math_len      = ("math.len" | "numpy.len") "(" expression ")" ;
math_get      = ("math.get" | "numpy.get") "(" expression "," expression ")" ;
math_set      = ("math.set" | "numpy.set") "(" expression "," expression "," expression ")" ;
math_push     = ("math.push" | "numpy.push") "(" expression "," expression ")" ;
math_pop      = ("math.pop" | "numpy.pop") "(" expression ")" ;
math_zeros    = ("math.zeros" | "numpy.zeros") "(" expression ")" ;
math_ones     = ("math.ones" | "numpy.ones") "(" expression ")" ;
math_arange   = ("math.arange" | "numpy.arange") "(" expression [ "," expression [ "," expression ] ] ")" ;
math_linspace = ("math.linspace" | "numpy.linspace") "(" expression "," expression "," expression ")" ;
math_sum      = ("math.sum" | "numpy.sum") "(" expression ")" ;
math_mean     = ("math.mean" | "numpy.mean") "(" expression ")" ;
math_min      = ("math.min" | "numpy.min") "(" expression ")" ;
math_max      = ("math.max" | "numpy.max") "(" expression ")" ;
math_dot      = ("math.dot" | "numpy.dot") "(" expression "," expression ")" ;
math_add      = ("math.add" | "numpy.add") "(" expression "," expression ")" ;
math_sub      = ("math.sub" | "numpy.sub") "(" expression "," expression ")" ;
math_mul      = ("math.mul" | "numpy.mul") "(" expression "," expression ")" ;
math_div      = ("math.div" | "numpy.div") "(" expression "," expression ")" ;
math_clip     = ("math.clip" | "numpy.clip") "(" expression "," expression "," expression ")" ;
math_abs      = ("math.abs" | "numpy.abs") "(" expression ")" ;
gfx_open      = "gfx.open" "(" expression "," expression ")" ;
gfx_clear     = "gfx.clear" "(" expression "," expression "," expression ")" ;
gfx_pixel     = "gfx.pixel" "(" expression "," expression "," expression "," expression "," expression ")" ;
gfx_line      = "gfx.line" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_line_thk  = "gfx.line_thick" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_triangle  = "gfx.triangle" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_rect      = "gfx.rect" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_rr        = "gfx.rounded_rect" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_grad_rect = "gfx.gradient_rect" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_rect_o    = "gfx.rect_outline" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_circle    = "gfx.circle" "(" expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_circle_o  = "gfx.circle_outline" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_save      = "gfx.save" "(" string_lit ")" ;
gfx_save_fr   = "gfx.save_frame" "(" string_lit "," expression ")" ;
gfx_width     = "gfx.width" "(" ")" ;
gfx_height    = "gfx.height" "(" ")" ;
gfx_frame     = "gfx.frame" "(" ")" ;
gfx_window    = "gfx.window" "(" expression "," expression "," string_lit ")" ;
gfx_wratio    = "gfx.window_ratio" "(" expression "," expression "," expression "," expression "," string_lit ")" ;
gfx_kaspect   = "gfx.keep_aspect" "(" expression ")" ;
gfx_rrate     = "gfx.refresh_rate" "(" expression ")" ;
gfx_seed      = "gfx.seed" "(" expression ")" ;
gfx_cam_set   = "gfx.camera2d_set" "(" expression "," expression ")" ;
gfx_cam_move  = "gfx.camera2d_move" "(" expression "," expression ")" ;
gfx_cam_x     = "gfx.camera2d_x" "(" ")" ;
gfx_cam_y     = "gfx.camera2d_y" "(" ")" ;
gfx_cam_reset = "gfx.camera2d_reset" "(" ")" ;
gfx_poll      = "gfx.poll" "(" ")" ;
gfx_present   = "gfx.present" "(" ")" ;
gfx_sync      = "gfx.sync" "(" ")" ;
gfx_key       = "gfx.key_down" "(" expression ")" ;
gfx_mouse_x   = "gfx.mouse_x" "(" ")" ;
gfx_mouse_y   = "gfx.mouse_y" "(" ")" ;
gfx_mouse_d   = "gfx.mouse_down" "(" expression ")" ;
gfx_mouse_dx  = "gfx.mouse_dx" "(" ")" ;
gfx_mouse_dy  = "gfx.mouse_dy" "(" ")" ;
gfx_mouse_lk  = "gfx.mouse_lock" "(" expression ")" ;
gfx_mouse_sh  = "gfx.mouse_show" "(" expression ")" ;
gfx_button    = "gfx.button" "(" expression "," expression "," expression "," expression ")" ;
gfx_closed    = "gfx.closed" "(" ")" ;
gfx_close     = "gfx.close" "(" ")" ;
gfx_load_sp   = "gfx.load_sprite" "(" string_lit ")" ;
gfx_draw_sp   = "gfx.draw_sprite" "(" expression "," expression "," expression ")" ;
gfx_draw_sps  = "gfx.draw_sprite_scaled" "(" expression "," expression "," expression "," expression "," expression ")" ;
gfx_draw_spt  = "gfx.draw_sprite_tinted" "(" expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_draw_sst  = "gfx.draw_sprite_scaled_tinted" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_draw_srot = "gfx.draw_sprite_rotated" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_tmap_cr   = "gfx.tilemap_create" "(" expression "," expression "," expression "," expression ")" ;
gfx_tmap_set  = "gfx.tilemap_set" "(" expression "," expression "," expression "," expression ")" ;
gfx_tmap_get  = "gfx.tilemap_get" "(" expression "," expression "," expression ")" ;
gfx_tmap_fill = "gfx.tilemap_fill" "(" expression "," expression ")" ;
gfx_tmap_w    = "gfx.tilemap_width" "(" expression ")" ;
gfx_tmap_h    = "gfx.tilemap_height" "(" expression ")" ;
gfx_tmap_dr   = "gfx.tilemap_draw" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_pspawn    = "gfx.particles_spawn" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_pupdate   = "gfx.particles_update" "(" ")" ;
gfx_pdraw     = "gfx.particles_draw" "(" expression ")" ;
gfx_pclear    = "gfx.particles_clear" "(" ")" ;
gfx_pcount    = "gfx.particles_count" "(" ")" ;
gfx_shake     = "gfx.shake" "(" expression "," expression ")" ;
gfx_draw_spr  = "gfx.draw_sprite_region" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_npatch    = "gfx.nine_patch" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_shader_s  = "gfx.shader_set" "(" expression "," expression "," expression "," expression ")" ;
gfx_shader_c  = "gfx.shader_clear" "(" ")" ;
gfx_shader_cr = "gfx.shader_create" "(" ")" ;
gfx_shader_pc = "gfx.shader_program_clear" "(" expression ")" ;
gfx_shader_ad = "gfx.shader_add" "(" expression "," expression "," expression "," expression "," expression ")" ;
gfx_shader_pl = "gfx.shader_program_len" "(" expression ")" ;
gfx_shader_up = "gfx.shader_use_program" "(" expression ")" ;
gfx_anim_reg  = "gfx.anim_register" "(" expression "," expression "," expression "," expression ")" ;
gfx_anim_fr   = "gfx.anim_frame" "(" expression "," expression ")" ;
gfx_anim_len  = "gfx.anim_length" "(" expression ")" ;
gfx_anim_dr   = "gfx.anim_draw" "(" expression "," expression "," expression "," expression ")" ;
gfx_anim_drs  = "gfx.anim_draw_scaled" "(" expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_text      = "gfx.text" "(" expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_text_s    = "gfx.text_scaled" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
time_sleep    = "time.sleep_ms" "(" expression ")" ;
time_now      = "time.now_ms" "(" ")" ;
time_delta    = "time.delta_ms" "(" ")" ;
audio_play    = "audio.play_wav" "(" string_lit "," expression ")" ;
audio_stop    = "audio.stop" "(" ")" ;
gx3d_reset    = "gx3d.reset" "(" ")" ;
gx3d_camera   = "gx3d.camera" "(" expression "," expression "," expression ")" ;
gx3d_cmove    = "gx3d.camera_move" "(" expression "," expression "," expression ")" ;
gx3d_camx     = "gx3d.camera_x" "(" ")" ;
gx3d_camy     = "gx3d.camera_y" "(" ")" ;
gx3d_camz     = "gx3d.camera_z" "(" ")" ;
gx3d_rotate   = "gx3d.rotate" "(" expression "," expression "," expression ")" ;
gx3d_rotadd   = "gx3d.rotate_add" "(" expression "," expression "," expression ")" ;
gx3d_trans    = "gx3d.translate" "(" expression "," expression "," expression ")" ;
gx3d_scale    = "gx3d.scale" "(" expression "," expression "," expression ")" ;
gx3d_su       = "gx3d.scale_uniform" "(" expression ")" ;
gx3d_fov      = "gx3d.fov" "(" expression ")" ;
gx3d_clip     = "gx3d.clip" "(" expression "," expression ")" ;
gx3d_bfc      = "gx3d.backface_cull" "(" expression ")" ;
gx3d_dbias    = "gx3d.depth_bias" "(" expression ")" ;
gx3d_point    = "gx3d.point" "(" expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_line     = "gx3d.line" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_cube     = "gx3d.cube" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_cube_s   = "gx3d.cube_solid" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_tri      = "gx3d.triangle" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_tri_s    = "gx3d.triangle_solid" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_quad     = "gx3d.quad" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_quad_s   = "gx3d.quad_solid" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_pyr      = "gx3d.pyramid" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_pyr_s    = "gx3d.pyramid_solid" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_cube_t   = "gx3d.cube_sprite" "(" expression "," expression "," expression "," expression "," expression ")" ;
gx3d_cuboid   = "gx3d.cuboid" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_cuboid_s = "gx3d.cuboid_solid" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_cuboid_t = "gx3d.cuboid_sprite" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_sphere   = "gx3d.sphere" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_axis     = "gx3d.axis" "(" expression ")" ;
gx3d_grid     = "gx3d.grid" "(" expression "," expression "," expression ")" ;
gx3d_wsx      = "gx3d.world_to_screen_x" "(" expression "," expression "," expression ")" ;
gx3d_wsy      = "gx3d.world_to_screen_y" "(" expression "," expression "," expression ")" ;
gx3d_wvis     = "gx3d.world_visible" "(" expression "," expression "," expression ")" ;
gx3d_label    = "gx3d.label" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;

ident         = letter { letter | digit | "_" } ;
int_lit       = digit { digit } ;
string_lit    = '"' { any_char - '"' } '"' ;
comment       = "#" { any_char - newline } ;
newline       = "\n" ;
