program       = { newline | comment } [ statement { separator statement } ] { newline | comment } ;
statement     = import_stmt | let_stmt | if_stmt | while_stmt | expr_stmt ;
import_stmt   = "import" module_name "as" ident ;
module_name   = ident { "." ident } ;
let_stmt      = "let" ident "=" expression ;
if_stmt       = "if" expression ":" newline block "end" ;
while_stmt    = "while" expression ":" newline block "end" ;
block         = { newline | comment } [ statement { separator statement } ] { newline | comment } ;
expr_stmt     = expression ;
separator     = { comment } newline { newline | comment } ;

expression    = comparison ;
comparison    = term { ("==" | "!=" | "<" | "<=" | ">" | ">=") term } ;
term          = unary { ("*" | "/") unary } ;
unary         = [ "-" ] primary ;
primary       = int_lit | string_lit | object_lit | variable | call | "(" expression ")" ;

variable      = ident { "." ident } ;
call          = callee "(" [ expression { "," expression } ] ")" ;
callee        = ident { "." ident } ;
object_lit    = "{" [ object_pair { "," object_pair } ] "}" ;
object_pair   = (ident | string_lit) ":" expression ;

# Built-ins (documented subset of valid calls)
print_call    = "print" "(" [ expression { "," expression } ] ")" ;
rand_seed     = "random.seed" "(" expression ")" ;
rand_int      = "random.randint" "(" expression "," expression ")" ;
rand_range    = "random.randrange" "(" expression "," expression ")" ;
rand_floati   = "random.random" "(" ")" ;
rand_chance   = "random.chance" "(" expression ")" ;
noise_seed    = "noise.seed" "(" expression ")" ;
noise_val2    = "noise.value2" "(" expression "," expression ")" ;
noise_val3    = "noise.value3" "(" expression "," expression "," expression ")" ;
noise_sm2     = "noise.smooth2" "(" expression "," expression "," expression ")" ;
noise_fr2     = "noise.fractal2" "(" expression "," expression "," expression "," expression "," expression ")" ;
gfx_open      = "gfx.open" "(" expression "," expression ")" ;
gfx_clear     = "gfx.clear" "(" expression "," expression "," expression ")" ;
gfx_pixel     = "gfx.pixel" "(" expression "," expression "," expression "," expression "," expression ")" ;
gfx_line      = "gfx.line" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_rect      = "gfx.rect" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_rect_o    = "gfx.rect_outline" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_circle    = "gfx.circle" "(" expression "," expression "," expression "," expression "," expression "," expression ")" ;
gfx_save      = "gfx.save" "(" string_lit ")" ;
gfx_save_fr   = "gfx.save_frame" "(" string_lit "," expression ")" ;
gfx_width     = "gfx.width" "(" ")" ;
gfx_height    = "gfx.height" "(" ")" ;
gfx_window    = "gfx.window" "(" expression "," expression "," string_lit ")" ;
gfx_wratio    = "gfx.window_ratio" "(" expression "," expression "," expression "," expression "," string_lit ")" ;
gfx_kaspect   = "gfx.keep_aspect" "(" expression ")" ;
gfx_poll      = "gfx.poll" "(" ")" ;
gfx_present   = "gfx.present" "(" ")" ;
gfx_key       = "gfx.key_down" "(" expression ")" ;
gfx_mouse_x   = "gfx.mouse_x" "(" ")" ;
gfx_mouse_y   = "gfx.mouse_y" "(" ")" ;
gfx_mouse_d   = "gfx.mouse_down" "(" expression ")" ;
gfx_mouse_dx  = "gfx.mouse_dx" "(" ")" ;
gfx_mouse_dy  = "gfx.mouse_dy" "(" ")" ;
gfx_mouse_lk  = "gfx.mouse_lock" "(" expression ")" ;
gfx_mouse_sh  = "gfx.mouse_show" "(" expression ")" ;
gfx_button    = "gfx.button" "(" expression "," expression "," expression "," expression ")" ;
gfx_closed    = "gfx.closed" "(" ")" ;
gfx_close     = "gfx.close" "(" ")" ;
gfx_load_sp   = "gfx.load_sprite" "(" string_lit ")" ;
gfx_draw_sp   = "gfx.draw_sprite" "(" expression "," expression "," expression ")" ;
gfx_draw_sps  = "gfx.draw_sprite_scaled" "(" expression "," expression "," expression "," expression "," expression ")" ;
time_sleep    = "time.sleep_ms" "(" expression ")" ;
gx3d_reset    = "gx3d.reset" "(" ")" ;
gx3d_camera   = "gx3d.camera" "(" expression "," expression "," expression ")" ;
gx3d_cmove    = "gx3d.camera_move" "(" expression "," expression "," expression ")" ;
gx3d_rotate   = "gx3d.rotate" "(" expression "," expression "," expression ")" ;
gx3d_rotadd   = "gx3d.rotate_add" "(" expression "," expression "," expression ")" ;
gx3d_trans    = "gx3d.translate" "(" expression "," expression "," expression ")" ;
gx3d_fov      = "gx3d.fov" "(" expression ")" ;
gx3d_clip     = "gx3d.clip" "(" expression "," expression ")" ;
gx3d_point    = "gx3d.point" "(" expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_line     = "gx3d.line" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_cube     = "gx3d.cube" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_cube_s   = "gx3d.cube_solid" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_cube_t   = "gx3d.cube_sprite" "(" expression "," expression "," expression "," expression "," expression ")" ;
gx3d_cuboid   = "gx3d.cuboid" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_cuboid_s = "gx3d.cuboid_solid" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_cuboid_t = "gx3d.cuboid_sprite" "(" expression "," expression "," expression "," expression "," expression "," expression "," expression ")" ;
gx3d_axis     = "gx3d.axis" "(" expression ")" ;
gx3d_grid     = "gx3d.grid" "(" expression "," expression "," expression ")" ;

ident         = letter { letter | digit | "_" } ;
int_lit       = digit { digit } ;
string_lit    = '"' { any_char - '"' } '"' ;
comment       = "#" { any_char - newline } ;
newline       = "\n" ;
